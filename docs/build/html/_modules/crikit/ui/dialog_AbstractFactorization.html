
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>crikit.ui.dialog_AbstractFactorization &#8212; CRIKit2 0.4.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">CRIKit2 0.4.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">crikit.ui.dialog_AbstractFactorization</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for crikit.ui.dialog_AbstractFactorization</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Abstract Factorization Class</span>

<span class="sd">Created on Mon Jul 25 10:44:03 2016</span>

<span class="sd">@author: chc</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span> <span class="k">as</span> <span class="nn">_sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">_np</span>
<span class="kn">import</span> <span class="nn">traceback</span> <span class="k">as</span> <span class="nn">_traceback</span>

<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span> <span class="k">as</span> <span class="n">_QtWidgets</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QApplication</span> <span class="k">as</span> <span class="n">_QApplication</span><span class="p">,</span>
                             <span class="n">QDialog</span> <span class="k">as</span> <span class="n">_QDialog</span><span class="p">,</span>
                             <span class="n">QMessageBox</span> <span class="k">as</span> <span class="n">_QMsg</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">PyQt5.QtCore</span> <span class="k">as</span> <span class="nn">_QtCore</span>

<span class="c1"># Import from Designer-based GUI</span>
<span class="kn">from</span> <span class="nn">crikit.ui.qt_Factorization</span> <span class="kn">import</span> <span class="n">Ui_Dialog</span> <span class="c1">### EDIT ###</span>

<span class="c1"># Generic imports for MPL-incorporation</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">_mpl</span>


<span class="kn">from</span> <span class="nn">sciplot.ui.widget_mpl</span> <span class="kn">import</span> <span class="n">MplCanvas</span> <span class="k">as</span> <span class="n">_MplCanvas</span>

<span class="n">_mpl</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Qt5Agg&#39;</span><span class="p">)</span>
<span class="n">_mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
<span class="n">_mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>

<div class="viewcode-block" id="DialogAbstractFactorization"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization">[docs]</a><span class="k">class</span> <span class="nc">DialogAbstractFactorization</span><span class="p">(</span><span class="n">_QDialog</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SubUiSVD : SVD SubUI</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DialogAbstractFactorization</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mpl_v1</span> <span class="o">=</span> <span class="n">_mpl</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="c1">##    def __init__(self, parent=None):</span>
<span class="c1">#        raise NotImplementedError(&#39;This is an abstract class.&#39;)</span>
<span class="c1">##        super(DialogAbstractFactorization, self).__init__(parent=parent) ### EDIT ###</span>
<span class="c1">##        self.setup()</span>
<span class="c1">##        self.setupData(img_shape=img_shape)</span>
<span class="c1">##        self.ui_changes()</span>
<span class="c1">#        pass</span>

        
<div class="viewcode-block" id="DialogAbstractFactorization.ui_changes"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.ui_changes">[docs]</a>    <span class="k">def</span> <span class="nf">ui_changes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Any changes to ui labels or otherwise for particular implementation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>
    
<div class="viewcode-block" id="DialogAbstractFactorization.setupData"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.setupData">[docs]</a>    <span class="k">def</span> <span class="nf">setupData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_shape</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_img_shape</span> <span class="o">=</span> <span class="n">img_shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_img_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img_shape</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_img_shape2D</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img_shape</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_img_size2D</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img_shape</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">prod</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_y</span> <span class="o">=</span> <span class="n">img_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_x</span> <span class="o">=</span> <span class="n">img_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_spectra</span> <span class="o">=</span> <span class="n">img_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_factors</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cube_all</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">img_all</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spect_all</span> <span class="o">=</span> <span class="kc">None</span></div>

        
<div class="viewcode-block" id="DialogAbstractFactorization.setup"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.setup">[docs]</a>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="c1"># Generic load/init designer-based GUI</span>
        <span class="c1"># super(DialogAbstractFactorization, self).__init__(parent) ### EDIT ###</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">Ui_Dialog</span><span class="p">()</span> <span class="c1">### EDIT ###</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="c1">### EDIT ###</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonNext</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonPrev</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonGoTo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonCancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reject</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonOk</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonClear</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonApply</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">applyCheckBoxes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonScript</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runScript</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_factor_visible</span> <span class="o">=</span> <span class="mi">6</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lcdSelectedFactors</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lcdMaxFactors</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_factors</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factorLabelCheckBoxes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">checkBox</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">checkBox_2</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">checkBox_3</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">checkBox_4</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">checkBox_5</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">checkBox_6</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_factor_visible</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_MplCanvas</span><span class="p">(</span><span class="n">subplot</span><span class="o">=</span><span class="mi">211</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mpl_v1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">gridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">gridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">gridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">gridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">gridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">gridLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span> <span class="o">=</span> <span class="n">_MplCanvas</span><span class="p">(</span><span class="n">subplot</span><span class="o">=</span><span class="mi">211</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mpl_v1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span> <span class="o">=</span> <span class="n">_MplCanvas</span><span class="p">(</span><span class="n">subplot</span><span class="o">=</span><span class="mi">211</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mpl_v1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">verticalLayout_3</span><span class="o">.</span><span class="n">insertWidget</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">verticalLayout_3</span><span class="o">.</span><span class="n">insertWidget</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_factor_visible</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factorLabelCheckBoxes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Keep: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unselected_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">all_factors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">all_factors</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span>

<div class="viewcode-block" id="DialogAbstractFactorization.applyCheckBoxes"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.applyCheckBoxes">[docs]</a>    <span class="k">def</span> <span class="nf">applyCheckBoxes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add checked singular values (and remove un-checked SVs)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">checkBox</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factorLabelCheckBoxes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span><span class="o">+</span><span class="n">count</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span><span class="o">+</span><span class="n">count</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="c1">#print(&#39;Self.S: {}&#39;.format(self.svddata.S[0:3]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lcdSelectedFactors</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateCurrentRemainder</span><span class="p">()</span></div>

<div class="viewcode-block" id="DialogAbstractFactorization.advance"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.advance">[docs]</a>    <span class="k">def</span> <span class="nf">advance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        View next set of SVs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;pushButtonPrev&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updatePlots</span><span class="p">(</span><span class="n">startnum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_factor_visible</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;pushButtonNext&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updatePlots</span><span class="p">(</span><span class="n">startnum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_factor_visible</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;pushButtonGoTo&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updatePlots</span><span class="p">(</span><span class="n">startnum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinBoxGoTo</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>
<div class="viewcode-block" id="DialogAbstractFactorization.runScript"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.runScript">[docs]</a>    <span class="k">def</span> <span class="nf">runScript</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run &quot;script&quot; of singular value selection</span>

<span class="sd">        Example:</span>
<span class="sd">            [1,2,3,5:7] = 1,2,3,5,6,7</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lineEditSelections</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">script</span> <span class="o">=</span> <span class="n">script</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
        <span class="n">script</span> <span class="o">=</span> <span class="n">script</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">script</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">count</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> value greater than maximum factor </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
                <span class="k">elif</span> <span class="n">count</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> value greater than maximum factor </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">_traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">msg_box</span> <span class="o">=</span> <span class="n">_QMsg</span><span class="p">(</span><span class="n">_QMsg</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span> <span class="s1">&#39;Script Error&#39;</span><span class="p">,</span> <span class="s1">&#39;There was a problem with the script command: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">script</span><span class="p">),</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">msg_box</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">updatePlots</span><span class="p">(</span><span class="n">startnum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lcdSelectedFactors</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateCurrentRemainder</span><span class="p">()</span></div>

<div class="viewcode-block" id="DialogAbstractFactorization.max_factors"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.max_factors">[docs]</a>    <span class="k">def</span> <span class="nf">max_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;max_factors method not implemented&#39;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="DialogAbstractFactorization.combiner"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.combiner">[docs]</a>    <span class="k">def</span> <span class="nf">combiner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;combiner method not implemented&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DialogAbstractFactorization.mean_spatial"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.mean_spatial">[docs]</a>    <span class="k">def</span> <span class="nf">mean_spatial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cube</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;mean_spatial method not implemented&#39;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="DialogAbstractFactorization.mean_spectral"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.mean_spectral">[docs]</a>    <span class="k">def</span> <span class="nf">mean_spectral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cube</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;mean_spectral method not implemented&#39;</span><span class="p">)</span></div>
               
<div class="viewcode-block" id="DialogAbstractFactorization.get_spatial_slice"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.get_spatial_slice">[docs]</a>    <span class="k">def</span> <span class="nf">get_spatial_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;get_spatial_slice method not implemented.&#39;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="DialogAbstractFactorization.get_spectral_slice"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.get_spectral_slice">[docs]</a>    <span class="k">def</span> <span class="nf">get_spectral_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;get_spectral_slice method not implemented.&#39;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="DialogAbstractFactorization.updateCurrentRemainder"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.updateCurrentRemainder">[docs]</a>    <span class="k">def</span> <span class="nf">updateCurrentRemainder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update image reconstructed (mean over spectral vector) using remaining \</span>
<span class="sd">        (unselected) singular values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cube_select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combiner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="p">)</span>
        <span class="n">img_select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_spatial</span><span class="p">(</span><span class="n">cube_select</span><span class="p">)</span>
        <span class="n">spect_select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_spectral</span><span class="p">(</span><span class="n">cube_select</span><span class="p">)</span>
        
        <span class="c1"># cube_nonselect = self.combiner(self.unselected_factors)</span>
        
        <span class="c1"># cube_nonselect = self.cube_all - cube_select</span>
        <span class="c1"># img_nonselect = self.mean_spatial(cube_nonselect)</span>
        <span class="c1"># spect_nonselect = self.mean_spectral(cube_nonselect)</span>
        <span class="n">img_nonselect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">img_all</span> <span class="o">-</span> <span class="n">img_select</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spect_select: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spect_select</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spect_select is None: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spect_select</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">spect_nonselect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spect_all</span> <span class="o">-</span> <span class="n">spect_select</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        
        <span class="c1"># s_lim = _np.abs(img_select).max()</span>
        <span class="n">s_lim</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">img_select</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">img_select</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_select</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> 
                                       <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">s_lim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spect_select</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconCurrent</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

        <span class="c1"># s_lim = _np.abs(img_nonselect).max()</span>
        <span class="n">s_lim</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">img_nonselect</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">img_nonselect</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_nonselect</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> 
                                         <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">s_lim</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">s_lim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spect_nonselect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconRemainder</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>
        

<div class="viewcode-block" id="DialogAbstractFactorization.updatePlots"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.updatePlots">[docs]</a>    <span class="k">def</span> <span class="nf">updatePlots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startnum</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update images and spectra of set of singular values starting at SV \</span>
<span class="sd">        number startnum</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">startnum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">startnum</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonPrev</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonNext</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">startnum</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_factor_visible</span><span class="p">:</span>
            <span class="n">startnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_factors</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_factor_visible</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonPrev</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonNext</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonPrev</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pushButtonNext</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span> <span class="o">=</span> <span class="n">startnum</span>

        <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_factor_visible</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

            <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spatial_slice</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span><span class="p">)</span>
            <span class="c1"># sl_lim = _np.abs(sl).max()</span>
            <span class="n">sl_lim</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sl</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">sl_lim</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">sl_lim</span><span class="p">,</span> 
                                                <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                                <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span> <span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_spectral_slice</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">factorLabelCheckBoxes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Keep: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">startnum</span> <span class="o">+</span> <span class="n">count</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factorWins</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span> <span class="o">+</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">factorLabelCheckBoxes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">factorLabelCheckBoxes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="DialogAbstractFactorization.clear"><a class="viewcode-back" href="../../../crikit.ui.html#crikit.ui.dialog_AbstractFactorization.DialogAbstractFactorization.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear selected singular values (i.e., none will be selected)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lcdSelectedFactors</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_factors</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateCurrentRemainder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updatePlots</span><span class="p">(</span><span class="n">startnum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_first_factor_visible</span><span class="p">)</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="c1">#     app = _QApplication(_sys.argv)</span>
<span class="c1">#     app.setStyle(&#39;Cleanlooks&#39;)</span>
<span class="c1">#     x = _np.linspace(100,200,50)</span>
<span class="c1">#     y = _np.linspace(200,300,50)</span>
<span class="c1">#     f = _np.linspace(500,3000,800)</span>
<span class="c1">#     Ex = 30*_np.exp((-(f-1750)**2/(200**2)))</span>
<span class="c1">#     Spectrum = _np.convolve(_np.flipud(Ex),Ex,mode=&#39;same&#39;)</span>

<span class="c1">#     data = _np.zeros((y.size,x.size,f.size))</span>

<span class="c1">#     for count in range(y.size):</span>
<span class="c1">#         data[count,:,:] = y[count]*_np.random.poisson(_np.dot(x[:,None],Spectrum[None,:]))</span>

<span class="c1">#     win = DialogAbstractFactorization.dialogAbstractFactorization(data, data.shape) ### EDIT ###</span>

<span class="c1">#     print(win)</span>


<span class="c1">#     _sys.exit(app.exec_())</span>
<span class="c1"># #    _sys.exit()</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">CRIKit2 0.4.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">crikit.ui.dialog_AbstractFactorization</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>